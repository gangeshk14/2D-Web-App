<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Crop Prediction Site</title>
    <!-- Remix icons-->
    <link href="{{ url_for('static', filename='styles/remixicon/fonts/remixicon.css') }}" rel="stylesheet">

    <!-- Libraries Stylesheet -->
    <link href="{{ url_for('static', filename='styles/animate.min.css') }}" rel="stylesheet">
    <link href="{{ url_for('static', filename='styles/bootstrap.min.css') }}" rel="stylesheet">
    <link href="{{ url_for('static', filename='styles/apexcharts.css') }}" rel="stylesheet">
    <!-- Template Stylesheet -->
    <link href="{{ url_for('static', filename='styles/style.css') }}" rel="stylesheet">
</head>

<body>
    <!-- Navbar Start -->
    <div class="container-fluid fixed-top px-0 wow fadeIn" data-wow-delay="0.1s">

        <nav class="navbar navbar-expand-lg navbar-light py-lg-0 px-lg-5 wow fadeIn" data-wow-delay="0.1s">
            <a href="/" class="navbar-brand ms-4 ms-lg-0">
                <h1 class="fw-bold text-danger m-0">Crop<span class="text-success">Predict</span></h1>
            </a>
            <button type="button" class="navbar-toggler me-4" data-bs-toggle="collapse" data-bs-target="#navbarCollapse">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarCollapse">
                <div class="navbar-nav ms-auto p-4 p-lg-0">
                    <a href="/" class="nav-item nav-link active">Home</a>
                    <a href="#cropReccomendation" class="nav-item nav-link">Crop Reccomendation</a>
                    <a href="#cropsOffered" class="nav-item nav-link">Crops Offered</a>
                </div>
            </div>
        </nav>
    </div>
    <!-- Navbar End -->

    <div class="container-fluid p-0 mb-5 wow fadeIn" data-wow-delay="0.1s">
        <div class="position-relative">
            <img class="w-100" src="{{ url_for('static', filename='img/carousel-1.jpg') }}" alt="Image">
            <div class="caption position-absolute top-50 start-50 translate-middle text-center text-white">
                <h1 class="display-2 mb-5 animated slideInDown text-white">A smart way to plant your crops</h1>
                <h2 class="display-6 mb-5 animated slideInDown text-white">Offering <b>13</b> crops in <b>14</b> of the most populated states in India</h2>
                <a href="#cropReccomendation" class="btn btn-danger rounded-pill py-sm-3 px-sm-5">Predict</a>
                <a href="#cropsOffered" class="btn btn-success rounded-pill py-sm-3 px-sm-5 ms-3">Crops</a>
            </div>
        </div>
    </div>

    <!-- Crop Prediction Start -->
    <div class="container-fluid bg-light my-5 py-6" id="cropReccomendation">
        <div class="container">
            <a id="scrollToPrediction"></a>
            <div class="section-header text-center mx-auto mb-5 wow fadeInUp" data-wow-delay="0.1s" style="max-width: 500px;">
                <h1 class="display-5 mb-3">Crop Prediction</h1>
                <p>Please use the kit delivered to you to measure and enter soil conditions. Refer to the local meteorigical site for rainfall and temperature! </p>
            </div>
            <form id="predictCrop" method="post" autocomplete="off" action = "/#scrollToPrediction">
                <div class="row">
                    <div class="col-md-6 mb-4">
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text"><i class="ri-rainy-fill"></i></span>
                            </div>
                            <input type="text" class="form-control wow fadeInLeft" data-wow-delay="0.1s" pattern="[0-9]+(\.[0-9]+)?" title="Enter a valid value" placeholder="Rainfall" name="rainfall" value = "{{rainfall}}" required>
                        </div>
                    </div>
                    <div class="col-md-6 mb-4">
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text">Nitrogen</span>
                            </div>
                            <input type="text" class="form-control wow fadeInRight" data-wow-delay="0.1s" pattern="[0-9]+(\.[0-9]+)?" title="Enter a valid value" placeholder="N" name="n" value = "{{n}}" required>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6 mb-4">
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text">Phosphorus</span>
                            </div>
                            <input type="text" class="form-control wow fadeInLeft" data-wow-delay="0.1s" pattern="[0-9]+(\.[0-9]+)?" title="Enter a valid value" placeholder="P" name="p" value = "{{p}}" required>
                        </div>
                    </div>
                    <div class="col-md-6 mb-4">
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text">Potassium</span>
                            </div>
                            <input type="text" class="form-control wow fadeInRight" data-wow-delay="0.1s" pattern="[0-9]+(\.[0-9]+)?" title="Enter a valid value" placeholder="K" name="k" value = "{{k}}" required>
                        </div>
                    </div>
                </div>
        
                <div class="row">
                    <div class="col-md-6 mb-4">
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text">pH</span>
                            </div>
                            <input type="text" class="form-control wow fadeInLeft" data-wow-delay="0.1s" pattern="[0-9]+(\.[0-9]+)?" title="Enter a valid value" placeholder="pH" name="ph" value = "{{ph}}" required>
                        </div>
                    </div>
                    <div class="col-md-6 mb-4">
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text"><i class="ri-calendar-event-fill"></i></span>
                            </div>
                            <input type="date" class="form-control wow fadeInRight" data-wow-delay="0.1s" placeholder="Date" name="date" value = "{{date}}" required>
                        </div>
                    </div>
                </div>
                
                <div class="row">
                    <div class="col-md-6 mb-4">
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text"><i class="ri-temp-cold-line"></i></span>
                            </div>
                            <input type="text" class="form-control wow fadeInLeft" data-wow-delay="0.1s" placeholder="Temperature" pattern="[0-9]+(\.[0-9]+)?" name="temperature" value = "{{temperature}}" required>
                        </div>
                    </div>
                    <div class="col-md-6 mb-4">
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text"><i class="ri-map-pin-line"></i></span>
                            </div>
                            <select class="form-control wow fadeInRight" data-wow-delay="0.1s" name="state_name" value = "{{state_name}}" required>
                                {% for state in states %}
                                <option value="{{ state }}">{{ state.capitalize() }}</option>
                                {% endfor %}                              
                            </select>
                        </div>
                    </div>
                </div>

        
                <button type="submit" class="btn btn-primary wow fadeInUp" data-wow-delay="0.3s" >Predict</button>
            </form>
            <div id="prediction-chart"></div>
            <script src="{{ url_for('static', filename='scripts/apexcharts.min.js') }}"></script>
            {% if prediction_dict %}
                <!-- Display the bar chart -->

                <!-- JavaScript code to initialize ApexCharts -->
                <script>
                    // Extracted data from Flask route
                    var chartData = {{ prediction_dict | tojson | safe }};
                    // Generate series
                    var series = Object.keys(chartData).map(function(key) {
                        return {
                            name: key,
                            data: [chartData[key]]
                        };
                    });

                    // var categories = ['Prediction'];
                    // Configuration for ApexCharts
                    var options = {
                        series: [{
                            data: Object.values(chartData)
                        }],
                        chart: {
                            type: 'bar',
                            height: 380
                        },
                        plotOptions: {
                            bar: {
                                barHeight: '100%',
                                distributed: true,
                                horizontal: true,
                                dataLabels: {
                                    position: 'bottom'
                                },
                            }
                        },
                        colors: ['#33b2df', '#546E7A', '#d4526e', '#13d8aa', '#A5978B', '#2b908f', '#f9a3a4', '#90ee7e',
                        '#f48024', '#69d2e7', '#fa8b9e', '#ffc107', '#8bc34a'], // Add colors for your bars
                        dataLabels: {
                            enabled: true,
                            textAnchor: 'start',
                            style: {
                                colors: ['#fff']
                            },
                            formatter: function (val, opt) {
                                return opt.w.globals.labels[opt.dataPointIndex] + ":  " + val
                            },
                            offsetX: 0,
                            dropShadow: {
                                enabled: true
                            }
                        },
                        stroke: {
                            width: 1,
                            colors: ['#fff']
                        },
                        xaxis: {
                            categories: Object.keys(chartData) // Use keys from your prediction_dict as categories
                        },
                        yaxis: {
                            labels: {
                                show: false
                            }
                        },
                        title: {
                            text: 'Crop Yield Prediction',
                            align: 'center',
                            floating: true
                        },
                        subtitle: {
                            text: 'Crop and its yield(t ha-1) in each bar. Yield is in Ton per hectare',
                            align: 'center',
                        },
                        tooltip: {
                            theme: 'dark',
                            x: {
                                show: false
                            },
                            y: {
                                title: {
                                    formatter: function () {
                                        return ''
                                    }
                                }
                            }
                        }
                    };

                    // Initialize ApexCharts
                    var chart = new ApexCharts(document.querySelector("#prediction-chart"), options);
                    chart.render();
                </script>
            {% endif %}
        </div>
    </div>
    <!-- Crop Prediction End -->


    <!-- Product Start -->
    <div class="container-xxl py-5" id="cropsOffered">
        <div class="container">
            <div class="row g-0 gx-5 align-items-end">
                <div class="col-lg-6">
                    <div class="section-header text-start mb-5 wow fadeInUp" data-wow-delay="0.1s" style="max-width: 500px;">
                        <h1 class="display-5 mb-3">Our Crops</h1>
                    </div>
                </div>
                <div class="col-lg-6 text-start text-lg-end wow slideInRight" data-wow-delay="0.1s">
                    <ul class="nav nav-pills d-inline-flex justify-content-end mb-5">
                        <li class="nav-item me-2">
                            <a class="btn btn-outline-success border-2 active" data-bs-toggle="pill" href="#tab-1">1</a>
                        </li>
                        <li class="nav-item me-2">
                            <a class="btn btn-outline-success border-2" data-bs-toggle="pill" href="#tab-2">2 </a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="tab-content">
                <div id="tab-1" class="tab-pane fade show p-0 active">
                    <div class="row g-4">
                        {% for img_filename in img_filenames_tab1 %}
                        <div class="col-xl-3 col-lg-4 col-md-6 wow fadeInUp" data-wow-delay="{{ loop.index * 0.1 }}s">
                            <div class="product-item">
                                <div class="position-relative bg-light overflow-hidden">
                                    <div class="square-container">
                                        <img class="img-fluid square-image" src="{{ url_for('static', filename='img/' + img_filename) }}" alt="{{ img_filename }}">
                                    </div>
                                </div>
                                <div class="text-center p-4">
                                    <a class="d-block h5 mb-2">{{ img_filename.split('.')[0] }}</a>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                <div id="tab-2" class="tab-pane fade show p-0">
                    <div class="row g-4">
                        {% for img_filename in img_filenames_tab2 %}
                        <div class="col-xl-3 col-lg-4 col-md-6 wow fadeInUp">
                            <div class="product-item">
                                <div class="position-relative bg-light overflow-hidden">
                                    <div class="square-container">
                                        <img class="img-fluid square-image" src="{{ url_for('static', filename='img/' + img_filename) }}" alt="{{ img_filename }}">
                                    </div>
                                </div>
                                <div class="text-center p-4">
                                    <a class="d-block h5 mb-2">{{ img_filename.split('.')[0] }}</a>
                                </div>
                            </div>
                        </div>
                        {% endfor %} 
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Product End -->
    <!-- Back to Top -->
    <a href="#" class="btn btn-lg btn-primary btn-lg-square rounded-circle back-to-top"><i class="ri-arrow-up-line"></i></a>


    <!-- JavaScript Libraries -->
    <script src="{{ url_for('static', filename='scripts/jquery.min.js') }}"></script>
    <script src="{{ url_for('static', filename='scripts/bootstrap.min.js') }}"></script>
    <script src="{{ url_for('static', filename='scripts/wow.min.js') }}"></script>

    <!-- Template Javascript -->
    <script src="{{ url_for('static', filename='scripts/main.js') }}"></script>
</body>

</html>